{"timestamp": "2025-03-23T10:36:33.146434", "level": "ERROR", "message": "Request failed", "module": "logging", "function": "dispatch", "line": 57, "exception": {"type": "ResponseValidationError", "message": "1 validation errors:\n  {'type': 'model_attributes_type', 'loc': ('response',), 'msg': 'Input should be a valid dictionary or object to extract fields from', 'input': <coroutine object PitchService.get_all_pitchgroups at 0x786d20eeb140>, 'url': 'https://errors.pydantic.dev/2.10/v/model_attributes_type'}\n", "traceback": "Traceback (most recent call last):\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/site-packages/anyio/streams/memory.py\", line 98, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/site-packages/anyio/streams/memory.py\", line 93, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/site-packages/starlette/middleware/base.py\", line 78, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/site-packages/anyio/streams/memory.py\", line 118, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/yu/gitdev/shengyibaodian/app/middleware/logging.py\", line 34, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/site-packages/starlette/middleware/base.py\", line 84, in call_next\n    raise app_exc\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/site-packages/starlette/middleware/base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 83, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 79, in __call__\n    raise exc\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/site-packages/starlette/routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/site-packages/starlette/routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/site-packages/starlette/routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/site-packages/fastapi/routing.py\", line 292, in app\n    content = await serialize_response(\n              ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/site-packages/fastapi/routing.py\", line 155, in serialize_response\n    raise ResponseValidationError(\nfastapi.exceptions.ResponseValidationError: 1 validation errors:\n  {'type': 'model_attributes_type', 'loc': ('response',), 'msg': 'Input should be a valid dictionary or object to extract fields from', 'input': <coroutine object PitchService.get_all_pitchgroups at 0x786d20eeb140>, 'url': 'https://errors.pydantic.dev/2.10/v/model_attributes_type'}\n"}, "request_id": "27493124-886d-4a61-b6f7-37e0d7e953fe", "path": "/api/v1/piano/pitchgroup", "method": "GET"}
{"timestamp": "2025-03-23T10:41:02.650145", "level": "ERROR", "message": "Request failed", "module": "logging", "function": "dispatch", "line": 57, "exception": {"type": "ResponseValidationError", "message": "1 validation errors:\n  {'type': 'list_type', 'loc': ('response',), 'msg': 'Input should be a valid list', 'input': <coroutine object PitchService.get_all_pitchgroups at 0x7ff2fbd4adc0>, 'url': 'https://errors.pydantic.dev/2.10/v/list_type'}\n", "traceback": "Traceback (most recent call last):\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/site-packages/anyio/streams/memory.py\", line 98, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/site-packages/anyio/streams/memory.py\", line 93, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/site-packages/starlette/middleware/base.py\", line 78, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/site-packages/anyio/streams/memory.py\", line 118, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/yu/gitdev/shengyibaodian/app/middleware/logging.py\", line 34, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/site-packages/starlette/middleware/base.py\", line 84, in call_next\n    raise app_exc\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/site-packages/starlette/middleware/base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 83, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 79, in __call__\n    raise exc\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/site-packages/starlette/routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/site-packages/starlette/routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/site-packages/starlette/routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/site-packages/fastapi/routing.py\", line 292, in app\n    content = await serialize_response(\n              ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/site-packages/fastapi/routing.py\", line 155, in serialize_response\n    raise ResponseValidationError(\nfastapi.exceptions.ResponseValidationError: 1 validation errors:\n  {'type': 'list_type', 'loc': ('response',), 'msg': 'Input should be a valid list', 'input': <coroutine object PitchService.get_all_pitchgroups at 0x7ff2fbd4adc0>, 'url': 'https://errors.pydantic.dev/2.10/v/list_type'}\n"}, "request_id": "098922af-940b-4d88-82fd-39f85235f578", "path": "/api/v1/piano/pitchgroup", "method": "GET"}
{"timestamp": "2025-03-23T10:43:34.644487", "level": "ERROR", "message": "Request failed", "module": "logging", "function": "dispatch", "line": 57, "exception": {"type": "ResponseValidationError", "message": "9 validation errors:\n  {'type': 'missing', 'loc': ('response', 0, 'id'), 'msg': 'Field required', 'input': <app.models.pitch.PitchGroup object at 0x787e57ee7ad0>, 'url': 'https://errors.pydantic.dev/2.10/v/missing'}\n  {'type': 'missing', 'loc': ('response', 1, 'id'), 'msg': 'Field required', 'input': <app.models.pitch.PitchGroup object at 0x787e57ee7b90>, 'url': 'https://errors.pydantic.dev/2.10/v/missing'}\n  {'type': 'missing', 'loc': ('response', 2, 'id'), 'msg': 'Field required', 'input': <app.models.pitch.PitchGroup object at 0x787e57ee7b10>, 'url': 'https://errors.pydantic.dev/2.10/v/missing'}\n  {'type': 'missing', 'loc': ('response', 3, 'id'), 'msg': 'Field required', 'input': <app.models.pitch.PitchGroup object at 0x787e57ee7bd0>, 'url': 'https://errors.pydantic.dev/2.10/v/missing'}\n  {'type': 'missing', 'loc': ('response', 4, 'id'), 'msg': 'Field required', 'input': <app.models.pitch.PitchGroup object at 0x787e57ee7c90>, 'url': 'https://errors.pydantic.dev/2.10/v/missing'}\n  {'type': 'missing', 'loc': ('response', 5, 'id'), 'msg': 'Field required', 'input': <app.models.pitch.PitchGroup object at 0x787e57ee4090>, 'url': 'https://errors.pydantic.dev/2.10/v/missing'}\n  {'type': 'missing', 'loc': ('response', 6, 'id'), 'msg': 'Field required', 'input': <app.models.pitch.PitchGroup object at 0x787e57ee4050>, 'url': 'https://errors.pydantic.dev/2.10/v/missing'}\n  {'type': 'missing', 'loc': ('response', 7, 'id'), 'msg': 'Field required', 'input': <app.models.pitch.PitchGroup object at 0x787e57ee7c50>, 'url': 'https://errors.pydantic.dev/2.10/v/missing'}\n  {'type': 'missing', 'loc': ('response', 8, 'id'), 'msg': 'Field required', 'input': <app.models.pitch.PitchGroup object at 0x787e57ee7c10>, 'url': 'https://errors.pydantic.dev/2.10/v/missing'}\n", "traceback": "Traceback (most recent call last):\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/site-packages/anyio/streams/memory.py\", line 98, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/site-packages/anyio/streams/memory.py\", line 93, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/site-packages/starlette/middleware/base.py\", line 78, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/site-packages/anyio/streams/memory.py\", line 118, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/yu/gitdev/shengyibaodian/app/middleware/logging.py\", line 34, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/site-packages/starlette/middleware/base.py\", line 84, in call_next\n    raise app_exc\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/site-packages/starlette/middleware/base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 83, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 79, in __call__\n    raise exc\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/site-packages/starlette/routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/site-packages/starlette/routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/site-packages/starlette/routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/site-packages/fastapi/routing.py\", line 292, in app\n    content = await serialize_response(\n              ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/site-packages/fastapi/routing.py\", line 155, in serialize_response\n    raise ResponseValidationError(\nfastapi.exceptions.ResponseValidationError: 9 validation errors:\n  {'type': 'missing', 'loc': ('response', 0, 'id'), 'msg': 'Field required', 'input': <app.models.pitch.PitchGroup object at 0x787e57ee7ad0>, 'url': 'https://errors.pydantic.dev/2.10/v/missing'}\n  {'type': 'missing', 'loc': ('response', 1, 'id'), 'msg': 'Field required', 'input': <app.models.pitch.PitchGroup object at 0x787e57ee7b90>, 'url': 'https://errors.pydantic.dev/2.10/v/missing'}\n  {'type': 'missing', 'loc': ('response', 2, 'id'), 'msg': 'Field required', 'input': <app.models.pitch.PitchGroup object at 0x787e57ee7b10>, 'url': 'https://errors.pydantic.dev/2.10/v/missing'}\n  {'type': 'missing', 'loc': ('response', 3, 'id'), 'msg': 'Field required', 'input': <app.models.pitch.PitchGroup object at 0x787e57ee7bd0>, 'url': 'https://errors.pydantic.dev/2.10/v/missing'}\n  {'type': 'missing', 'loc': ('response', 4, 'id'), 'msg': 'Field required', 'input': <app.models.pitch.PitchGroup object at 0x787e57ee7c90>, 'url': 'https://errors.pydantic.dev/2.10/v/missing'}\n  {'type': 'missing', 'loc': ('response', 5, 'id'), 'msg': 'Field required', 'input': <app.models.pitch.PitchGroup object at 0x787e57ee4090>, 'url': 'https://errors.pydantic.dev/2.10/v/missing'}\n  {'type': 'missing', 'loc': ('response', 6, 'id'), 'msg': 'Field required', 'input': <app.models.pitch.PitchGroup object at 0x787e57ee4050>, 'url': 'https://errors.pydantic.dev/2.10/v/missing'}\n  {'type': 'missing', 'loc': ('response', 7, 'id'), 'msg': 'Field required', 'input': <app.models.pitch.PitchGroup object at 0x787e57ee7c50>, 'url': 'https://errors.pydantic.dev/2.10/v/missing'}\n  {'type': 'missing', 'loc': ('response', 8, 'id'), 'msg': 'Field required', 'input': <app.models.pitch.PitchGroup object at 0x787e57ee7c10>, 'url': 'https://errors.pydantic.dev/2.10/v/missing'}\n"}, "request_id": "0b59d441-16c7-411d-a6d7-b1bcac47c71f", "path": "/api/v1/piano/pitchgroup", "method": "GET"}
{"timestamp": "2025-03-23T10:46:04.310333", "level": "ERROR", "message": "Failed to initialize application", "module": "main", "function": "lifespan", "line": 54, "exception": {"type": "TypeError", "message": "PitchGroup.__init__() missing 1 required positional argument: 'count'", "traceback": "Traceback (most recent call last):\n  File \"/home/yu/gitdev/shengyibaodian/main.py\", line 50, in lifespan\n    pitch_service.build_pitch_group_cache()\n  File \"/home/yu/gitdev/shengyibaodian/app/services/pitch_service.py\", line 57, in build_pitch_group_cache\n    pitch_group = PitchGroup(\n                  ^^^^^^^^^^^\nTypeError: PitchGroup.__init__() missing 1 required positional argument: 'count'"}}
