{"timestamp": "2025-04-22T02:36:23.305585", "level": "ERROR", "message": "Error in generate_ai_melody_question : 'Request' object has no attribute 'difficulty'\nTraceback: Traceback (most recent call last):\n  File \"/home/yu/gitdev/shengyibaodian/app/api/v1/melody_api.py\", line 49, in generate_ai_melody_question\n    return await ai_melody_service.generate_melody_question(request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 36, in generate_melody_question\n    correct_melody = await self._generate_ai_melody(request)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 86, in _generate_ai_melody\n    prompt = self._build_melody_prompt(request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 101, in _build_melody_prompt\n    if request.difficulty == RhythmDifficulty.HIGH:\n       ^^^^^^^^^^^^^^^^^^\nAttributeError: 'Request' object has no attribute 'difficulty'\n", "module": "melody_api", "function": "generate_ai_melody_question", "line": 52}
{"timestamp": "2025-04-22T02:37:18.555306", "level": "ERROR", "message": "Error in generate_ai_melody_question : Expecting value: line 1 column 1 (char 0)\nTraceback: Traceback (most recent call last):\n  File \"/home/yu/gitdev/shengyibaodian/app/api/v1/melody_api.py\", line 49, in generate_ai_melody_question\n    return await ai_melody_service.generate_melody_question(melody_question_request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 36, in generate_melody_question\n    correct_melody = await self._generate_ai_melody(request)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 92, in _generate_ai_melody\n    melody = self._parse_ai_response(response, request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 160, in _parse_ai_response\n    melody_data = json.loads(response[\"choices\"][0][\"message\"][\"content\"])\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/__init__.py\", line 346, in loads\n    return _default_decoder.decode(s)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/decoder.py\", line 337, in decode\n    obj, end = self.raw_decode(s, idx=_w(s, 0).end())\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/decoder.py\", line 355, in raw_decode\n    raise JSONDecodeError(\"Expecting value\", s, err.value) from None\njson.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)\n", "module": "melody_api", "function": "generate_ai_melody_question", "line": 52}
{"timestamp": "2025-04-22T02:42:33.131332", "level": "ERROR", "message": "Error in generate_ai_melody_question : Expecting value: line 1 column 1 (char 0)\nTraceback: Traceback (most recent call last):\n  File \"/home/yu/gitdev/shengyibaodian/app/api/v1/melody_api.py\", line 49, in generate_ai_melody_question\n    return await ai_melody_service.generate_melody_question(melody_question_request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 39, in generate_melody_question\n    correct_melody = await self._generate_ai_melody(request)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 107, in _generate_ai_melody\n    melody = self._parse_ai_response(response, request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 185, in _parse_ai_response\n    melody_data = json.loads(response[\"choices\"][0][\"message\"][\"content\"])\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/__init__.py\", line 346, in loads\n    return _default_decoder.decode(s)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/decoder.py\", line 337, in decode\n    obj, end = self.raw_decode(s, idx=_w(s, 0).end())\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/decoder.py\", line 355, in raw_decode\n    raise JSONDecodeError(\"Expecting value\", s, err.value) from None\njson.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)\n", "module": "melody_api", "function": "generate_ai_melody_question", "line": 52}
{"timestamp": "2025-04-22T05:44:07.146130", "level": "ERROR", "message": "Error in generate_ai_melody_question : Expecting value: line 1 column 1 (char 0)\nTraceback: Traceback (most recent call last):\n  File \"/home/yu/gitdev/shengyibaodian/app/api/v1/melody_api.py\", line 49, in generate_ai_melody_question\n    return await ai_melody_service.generate_melody_question(melody_question_request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 39, in generate_melody_question\n    correct_melody = await self._generate_ai_melody(request)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 107, in _generate_ai_melody\n    melody = self._parse_ai_response(response, request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 187, in _parse_ai_response\n    melody_data = json.loads(response[\"choices\"][0][\"message\"][\"content\"])\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/__init__.py\", line 346, in loads\n    return _default_decoder.decode(s)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/decoder.py\", line 337, in decode\n    obj, end = self.raw_decode(s, idx=_w(s, 0).end())\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/decoder.py\", line 355, in raw_decode\n    raise JSONDecodeError(\"Expecting value\", s, err.value) from None\njson.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)\n", "module": "melody_api", "function": "generate_ai_melody_question", "line": 52}
{"timestamp": "2025-04-22T05:44:07.166911", "level": "ERROR", "message": "Error in generate_melody_question : tuple indices must be integers or slices, not RhythmDifficulty\nTraceback: Traceback (most recent call last):\n  File \"/home/yu/gitdev/shengyibaodian/app/api/v1/melody_api.py\", line 30, in generate_melody_question\n    response = melody_service.generate_question(melody_question_request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/melody_service.py\", line 29, in generate_question\n    correct_melody = self.generate_melody(\n                     ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/melody_service.py\", line 88, in generate_melody\n    rhythm = rhythm_service.generate_rhythm(\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/rhythm_service.py\", line 237, in generate_rhythm\n    patterns = self.rhythm_patterns[difficulty][time_signature]\n               ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^\nTypeError: tuple indices must be integers or slices, not RhythmDifficulty\n", "module": "melody_api", "function": "generate_melody_question", "line": 33}
{"timestamp": "2025-04-22T05:44:07.177350", "level": "ERROR", "message": "Error in generate_melody_question : tuple indices must be integers or slices, not RhythmDifficulty\nTraceback: Traceback (most recent call last):\n  File \"/home/yu/gitdev/shengyibaodian/app/api/v1/melody_api.py\", line 30, in generate_melody_question\n    response = melody_service.generate_question(melody_question_request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/melody_service.py\", line 29, in generate_question\n    correct_melody = self.generate_melody(\n                     ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/melody_service.py\", line 88, in generate_melody\n    rhythm = rhythm_service.generate_rhythm(\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/rhythm_service.py\", line 237, in generate_rhythm\n    patterns = self.rhythm_patterns[difficulty][time_signature]\n               ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^\nTypeError: tuple indices must be integers or slices, not RhythmDifficulty\n", "module": "melody_api", "function": "generate_melody_question", "line": 33}
{"timestamp": "2025-04-22T05:44:44.497423", "level": "ERROR", "message": "Error in generate_melody_question : tuple indices must be integers or slices, not RhythmDifficulty\nTraceback: Traceback (most recent call last):\n  File \"/home/yu/gitdev/shengyibaodian/app/api/v1/melody_api.py\", line 30, in generate_melody_question\n    response = melody_service.generate_question(melody_question_request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/melody_service.py\", line 29, in generate_question\n    correct_melody = self.generate_melody(\n                     ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/melody_service.py\", line 88, in generate_melody\n    rhythm = rhythm_service.generate_rhythm(\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/rhythm_service.py\", line 237, in generate_rhythm\n    patterns = self.rhythm_patterns[difficulty][time_signature]\n               ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^\nTypeError: tuple indices must be integers or slices, not RhythmDifficulty\n", "module": "melody_api", "function": "generate_melody_question", "line": 33}
{"timestamp": "2025-04-22T05:50:04.435631", "level": "ERROR", "message": "Error in generate_melody_question : tuple indices must be integers or slices, not RhythmDifficulty\nTraceback: Traceback (most recent call last):\n  File \"/home/yu/gitdev/shengyibaodian/app/api/v1/melody_api.py\", line 30, in generate_melody_question\n    response = melody_service.generate_question(melody_question_request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/melody_service.py\", line 29, in generate_question\n    correct_melody = self.generate_melody(\n                     ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/melody_service.py\", line 88, in generate_melody\n    rhythm = rhythm_service.generate_rhythm(\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/rhythm_service.py\", line 237, in generate_rhythm\n    patterns = self.rhythm_patterns[difficulty][time_signature]\n               ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^\nTypeError: tuple indices must be integers or slices, not RhythmDifficulty\n", "module": "melody_api", "function": "generate_melody_question", "line": 33}
{"timestamp": "2025-04-22T05:52:12.604037", "level": "ERROR", "message": "Error in generate_melody_question : tuple indices must be integers or slices, not str\nTraceback: Traceback (most recent call last):\n  File \"/home/yu/gitdev/shengyibaodian/app/api/v1/melody_api.py\", line 30, in generate_melody_question\n    response = melody_service.generate_question(melody_question_request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/melody_service.py\", line 29, in generate_question\n    correct_melody = self.generate_melody(\n                     ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/melody_service.py\", line 88, in generate_melody\n    rhythm = rhythm_service.generate_rhythm(\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/rhythm_service.py\", line 237, in generate_rhythm\n    patterns = self.rhythm_patterns[difficulty.value][time_signature.value]\n               ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^\nTypeError: tuple indices must be integers or slices, not str\n", "module": "melody_api", "function": "generate_melody_question", "line": 33}
{"timestamp": "2025-04-22T05:52:19.188706", "level": "ERROR", "message": "Error in generate_melody_question : tuple indices must be integers or slices, not str\nTraceback: Traceback (most recent call last):\n  File \"/home/yu/gitdev/shengyibaodian/app/api/v1/melody_api.py\", line 30, in generate_melody_question\n    response = melody_service.generate_question(melody_question_request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/melody_service.py\", line 29, in generate_question\n    correct_melody = self.generate_melody(\n                     ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/melody_service.py\", line 88, in generate_melody\n    rhythm = rhythm_service.generate_rhythm(\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/rhythm_service.py\", line 237, in generate_rhythm\n    patterns = self.rhythm_patterns[difficulty.value][time_signature.value]\n               ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^\nTypeError: tuple indices must be integers or slices, not str\n", "module": "melody_api", "function": "generate_melody_question", "line": 33}
{"timestamp": "2025-04-22T05:53:19.084650", "level": "ERROR", "message": "Error in generate_melody_question : tuple indices must be integers or slices, not RhythmDifficulty\nTraceback: Traceback (most recent call last):\n  File \"/home/yu/gitdev/shengyibaodian/app/api/v1/melody_api.py\", line 30, in generate_melody_question\n    response = melody_service.generate_question(melody_question_request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/melody_service.py\", line 29, in generate_question\n    correct_melody = self.generate_melody(\n                     ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/melody_service.py\", line 88, in generate_melody\n    rhythm = rhythm_service.generate_rhythm(\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/rhythm_service.py\", line 237, in generate_rhythm\n    patterns = self.rhythm_patterns[difficulty][time_signature]\n               ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^\nTypeError: tuple indices must be integers or slices, not RhythmDifficulty\n", "module": "melody_api", "function": "generate_melody_question", "line": 33}
{"timestamp": "2025-04-22T06:45:29.193398", "level": "ERROR", "message": "Error in generate_ai_melody_question : Expecting value: line 1 column 1 (char 0)\nTraceback: Traceback (most recent call last):\n  File \"/home/yu/gitdev/shengyibaodian/app/api/v1/melody_api.py\", line 49, in generate_ai_melody_question\n    return await ai_melody_service.generate_melody_question(melody_question_request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 39, in generate_melody_question\n    correct_melody = await self._generate_ai_melody(request)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 107, in _generate_ai_melody\n    melody = self._parse_ai_response(response, request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 187, in _parse_ai_response\n    melody_data = json.loads(response[\"choices\"][0][\"message\"][\"content\"])\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/__init__.py\", line 346, in loads\n    return _default_decoder.decode(s)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/decoder.py\", line 337, in decode\n    obj, end = self.raw_decode(s, idx=_w(s, 0).end())\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/decoder.py\", line 355, in raw_decode\n    raise JSONDecodeError(\"Expecting value\", s, err.value) from None\njson.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)\n", "module": "melody_api", "function": "generate_ai_melody_question", "line": 52}
{"timestamp": "2025-04-22T07:40:55.699215", "level": "ERROR", "message": "Error in generate_ai_melody_question : Expecting value: line 1 column 1 (char 0)\nTraceback: Traceback (most recent call last):\n  File \"/home/yu/gitdev/shengyibaodian/app/api/v1/melody_api.py\", line 49, in generate_ai_melody_question\n    return await ai_melody_service.generate_melody_question(melody_question_request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 42, in generate_melody_question\n    correct_melody = await self._generate_ai_melody(request)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 110, in _generate_ai_melody\n    melody = self._parse_ai_response(response, request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 217, in _parse_ai_response\n    melody_data = json.loads(response[\"choices\"][0][\"message\"][\"content\"])\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/__init__.py\", line 346, in loads\n    return _default_decoder.decode(s)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/decoder.py\", line 337, in decode\n    obj, end = self.raw_decode(s, idx=_w(s, 0).end())\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/decoder.py\", line 355, in raw_decode\n    raise JSONDecodeError(\"Expecting value\", s, err.value) from None\njson.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)\n", "module": "melody_api", "function": "generate_ai_melody_question", "line": 52}
{"timestamp": "2025-04-22T08:05:22.053129", "level": "ERROR", "message": "Error parsing AI response: Expecting value: line 2 column 13 (char 13)", "module": "ai_melody_service", "function": "_parse_ai_response", "line": 381, "exception": {"type": "JSONDecodeError", "message": "Expecting value: line 2 column 13 (char 13)", "traceback": "Traceback (most recent call last):\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 340, in _parse_ai_response\n    melody_data = json.loads(data)\n                  ^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/__init__.py\", line 346, in loads\n    return _default_decoder.decode(s)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/decoder.py\", line 337, in decode\n    obj, end = self.raw_decode(s, idx=_w(s, 0).end())\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/decoder.py\", line 355, in raw_decode\n    raise JSONDecodeError(\"Expecting value\", s, err.value) from None\njson.decoder.JSONDecodeError: Expecting value: line 2 column 13 (char 13)"}}
{"timestamp": "2025-04-22T08:05:24.287148", "level": "ERROR", "message": "Error generating AI melody: Expecting value: line 2 column 13 (char 13)", "module": "ai_melody_service", "function": "_generate_ai_melody", "line": 115, "exception": {"type": "JSONDecodeError", "message": "Expecting value: line 2 column 13 (char 13)", "traceback": "Traceback (most recent call last):\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 110, in _generate_ai_melody\n    melody = self._parse_ai_response({}, request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 340, in _parse_ai_response\n    melody_data = json.loads(data)\n                  ^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/__init__.py\", line 346, in loads\n    return _default_decoder.decode(s)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/decoder.py\", line 337, in decode\n    obj, end = self.raw_decode(s, idx=_w(s, 0).end())\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/decoder.py\", line 355, in raw_decode\n    raise JSONDecodeError(\"Expecting value\", s, err.value) from None\njson.decoder.JSONDecodeError: Expecting value: line 2 column 13 (char 13)"}}
{"timestamp": "2025-04-22T08:05:24.294795", "level": "ERROR", "message": "Error generating AI melody question: Expecting value: line 2 column 13 (char 13)", "module": "ai_melody_service", "function": "generate_melody_question", "line": 92, "exception": {"type": "JSONDecodeError", "message": "Expecting value: line 2 column 13 (char 13)", "traceback": "Traceback (most recent call last):\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 41, in generate_melody_question\n    correct_melody = await self._generate_ai_melody(request)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 110, in _generate_ai_melody\n    melody = self._parse_ai_response({}, request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 340, in _parse_ai_response\n    melody_data = json.loads(data)\n                  ^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/__init__.py\", line 346, in loads\n    return _default_decoder.decode(s)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/decoder.py\", line 337, in decode\n    obj, end = self.raw_decode(s, idx=_w(s, 0).end())\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/decoder.py\", line 355, in raw_decode\n    raise JSONDecodeError(\"Expecting value\", s, err.value) from None\njson.decoder.JSONDecodeError: Expecting value: line 2 column 13 (char 13)"}}
{"timestamp": "2025-04-22T08:05:24.296331", "level": "ERROR", "message": "Error in generate_ai_melody_question : Expecting value: line 2 column 13 (char 13)\nTraceback: Traceback (most recent call last):\n  File \"/home/yu/gitdev/shengyibaodian/app/api/v1/melody_api.py\", line 49, in generate_ai_melody_question\n    return await ai_melody_service.generate_melody_question(melody_question_request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 41, in generate_melody_question\n    correct_melody = await self._generate_ai_melody(request)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 110, in _generate_ai_melody\n    melody = self._parse_ai_response({}, request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 340, in _parse_ai_response\n    melody_data = json.loads(data)\n                  ^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/__init__.py\", line 346, in loads\n    return _default_decoder.decode(s)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/decoder.py\", line 337, in decode\n    obj, end = self.raw_decode(s, idx=_w(s, 0).end())\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/decoder.py\", line 355, in raw_decode\n    raise JSONDecodeError(\"Expecting value\", s, err.value) from None\njson.decoder.JSONDecodeError: Expecting value: line 2 column 13 (char 13)\n", "module": "melody_api", "function": "generate_ai_melody_question", "line": 52}
{"timestamp": "2025-04-22T08:06:16.043278", "level": "ERROR", "message": "Error parsing AI response: 1 validation error for MelodyNotePitch\npitch\n  Input should be a valid dictionary or object to extract fields from [type=model_attributes_type, input_value=[<app.models.pitch.Pitch ...ject at 0x7734d2fd0250>], input_type=list]\n    For further information visit https://errors.pydantic.dev/2.10/v/model_attributes_type", "module": "ai_melody_service", "function": "_parse_ai_response", "line": 379, "exception": {"type": "ValidationError", "message": "1 validation error for MelodyNotePitch\npitch\n  Input should be a valid dictionary or object to extract fields from [type=model_attributes_type, input_value=[<app.models.pitch.Pitch ...ject at 0x7734d2fd0250>], input_type=list]\n    For further information visit https://errors.pydantic.dev/2.10/v/model_attributes_type", "traceback": "Traceback (most recent call last):\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 357, in _parse_ai_response\n    melody_note = MelodyNotePitch(\n                  ^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/site-packages/pydantic/main.py\", line 214, in __init__\n    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\npydantic_core._pydantic_core.ValidationError: 1 validation error for MelodyNotePitch\npitch\n  Input should be a valid dictionary or object to extract fields from [type=model_attributes_type, input_value=[<app.models.pitch.Pitch ...ject at 0x7734d2fd0250>], input_type=list]\n    For further information visit https://errors.pydantic.dev/2.10/v/model_attributes_type"}}
{"timestamp": "2025-04-22T08:06:16.045959", "level": "ERROR", "message": "Error generating AI melody: 1 validation error for MelodyNotePitch\npitch\n  Input should be a valid dictionary or object to extract fields from [type=model_attributes_type, input_value=[<app.models.pitch.Pitch ...ject at 0x7734d2fd0250>], input_type=list]\n    For further information visit https://errors.pydantic.dev/2.10/v/model_attributes_type", "module": "ai_melody_service", "function": "_generate_ai_melody", "line": 115, "exception": {"type": "ValidationError", "message": "1 validation error for MelodyNotePitch\npitch\n  Input should be a valid dictionary or object to extract fields from [type=model_attributes_type, input_value=[<app.models.pitch.Pitch ...ject at 0x7734d2fd0250>], input_type=list]\n    For further information visit https://errors.pydantic.dev/2.10/v/model_attributes_type", "traceback": "Traceback (most recent call last):\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 110, in _generate_ai_melody\n    melody = self._parse_ai_response({}, request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 357, in _parse_ai_response\n    melody_note = MelodyNotePitch(\n                  ^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/site-packages/pydantic/main.py\", line 214, in __init__\n    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\npydantic_core._pydantic_core.ValidationError: 1 validation error for MelodyNotePitch\npitch\n  Input should be a valid dictionary or object to extract fields from [type=model_attributes_type, input_value=[<app.models.pitch.Pitch ...ject at 0x7734d2fd0250>], input_type=list]\n    For further information visit https://errors.pydantic.dev/2.10/v/model_attributes_type"}}
{"timestamp": "2025-04-22T08:06:16.049193", "level": "ERROR", "message": "Error generating AI melody question: 1 validation error for MelodyNotePitch\npitch\n  Input should be a valid dictionary or object to extract fields from [type=model_attributes_type, input_value=[<app.models.pitch.Pitch ...ject at 0x7734d2fd0250>], input_type=list]\n    For further information visit https://errors.pydantic.dev/2.10/v/model_attributes_type", "module": "ai_melody_service", "function": "generate_melody_question", "line": 92, "exception": {"type": "ValidationError", "message": "1 validation error for MelodyNotePitch\npitch\n  Input should be a valid dictionary or object to extract fields from [type=model_attributes_type, input_value=[<app.models.pitch.Pitch ...ject at 0x7734d2fd0250>], input_type=list]\n    For further information visit https://errors.pydantic.dev/2.10/v/model_attributes_type", "traceback": "Traceback (most recent call last):\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 41, in generate_melody_question\n    correct_melody = await self._generate_ai_melody(request)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 110, in _generate_ai_melody\n    melody = self._parse_ai_response({}, request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 357, in _parse_ai_response\n    melody_note = MelodyNotePitch(\n                  ^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/site-packages/pydantic/main.py\", line 214, in __init__\n    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\npydantic_core._pydantic_core.ValidationError: 1 validation error for MelodyNotePitch\npitch\n  Input should be a valid dictionary or object to extract fields from [type=model_attributes_type, input_value=[<app.models.pitch.Pitch ...ject at 0x7734d2fd0250>], input_type=list]\n    For further information visit https://errors.pydantic.dev/2.10/v/model_attributes_type"}}
{"timestamp": "2025-04-22T08:06:16.050626", "level": "ERROR", "message": "Error in generate_ai_melody_question : 1 validation error for MelodyNotePitch\npitch\n  Input should be a valid dictionary or object to extract fields from [type=model_attributes_type, input_value=[<app.models.pitch.Pitch ...ject at 0x7734d2fd0250>], input_type=list]\n    For further information visit https://errors.pydantic.dev/2.10/v/model_attributes_type\nTraceback: Traceback (most recent call last):\n  File \"/home/yu/gitdev/shengyibaodian/app/api/v1/melody_api.py\", line 49, in generate_ai_melody_question\n    return await ai_melody_service.generate_melody_question(melody_question_request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 41, in generate_melody_question\n    correct_melody = await self._generate_ai_melody(request)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 110, in _generate_ai_melody\n    melody = self._parse_ai_response({}, request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 357, in _parse_ai_response\n    melody_note = MelodyNotePitch(\n                  ^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/site-packages/pydantic/main.py\", line 214, in __init__\n    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\npydantic_core._pydantic_core.ValidationError: 1 validation error for MelodyNotePitch\npitch\n  Input should be a valid dictionary or object to extract fields from [type=model_attributes_type, input_value=[<app.models.pitch.Pitch ...ject at 0x7734d2fd0250>], input_type=list]\n    For further information visit https://errors.pydantic.dev/2.10/v/model_attributes_type\n", "module": "melody_api", "function": "generate_ai_melody_question", "line": 52}
{"timestamp": "2025-04-22T08:07:36.763362", "level": "ERROR", "message": "Error parsing AI response: 1 validation error for MelodyNotePitch\npitch\n  Input should be a valid dictionary or object to extract fields from [type=model_attributes_type, input_value=[<app.models.pitch.Pitch ...ject at 0x7734d2fd0250>], input_type=list]\n    For further information visit https://errors.pydantic.dev/2.10/v/model_attributes_type", "module": "ai_melody_service", "function": "_parse_ai_response", "line": 379, "exception": {"type": "ValidationError", "message": "1 validation error for MelodyNotePitch\npitch\n  Input should be a valid dictionary or object to extract fields from [type=model_attributes_type, input_value=[<app.models.pitch.Pitch ...ject at 0x7734d2fd0250>], input_type=list]\n    For further information visit https://errors.pydantic.dev/2.10/v/model_attributes_type", "traceback": "Traceback (most recent call last):\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 357, in _parse_ai_response\n    melody_note = MelodyNotePitch(\n                  ^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/site-packages/pydantic/main.py\", line 214, in __init__\n    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\npydantic_core._pydantic_core.ValidationError: 1 validation error for MelodyNotePitch\npitch\n  Input should be a valid dictionary or object to extract fields from [type=model_attributes_type, input_value=[<app.models.pitch.Pitch ...ject at 0x7734d2fd0250>], input_type=list]\n    For further information visit https://errors.pydantic.dev/2.10/v/model_attributes_type"}}
{"timestamp": "2025-04-22T08:08:21.848311", "level": "ERROR", "message": "Error generating AI melody: 1 validation error for MelodyNotePitch\npitch\n  Input should be a valid dictionary or object to extract fields from [type=model_attributes_type, input_value=[<app.models.pitch.Pitch ...ject at 0x7734d2fd0250>], input_type=list]\n    For further information visit https://errors.pydantic.dev/2.10/v/model_attributes_type", "module": "ai_melody_service", "function": "_generate_ai_melody", "line": 115, "exception": {"type": "ValidationError", "message": "1 validation error for MelodyNotePitch\npitch\n  Input should be a valid dictionary or object to extract fields from [type=model_attributes_type, input_value=[<app.models.pitch.Pitch ...ject at 0x7734d2fd0250>], input_type=list]\n    For further information visit https://errors.pydantic.dev/2.10/v/model_attributes_type", "traceback": "Traceback (most recent call last):\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 110, in _generate_ai_melody\n    melody = self._parse_ai_response({}, request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 357, in _parse_ai_response\n    melody_note = MelodyNotePitch(\n                  ^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/site-packages/pydantic/main.py\", line 214, in __init__\n    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\npydantic_core._pydantic_core.ValidationError: 1 validation error for MelodyNotePitch\npitch\n  Input should be a valid dictionary or object to extract fields from [type=model_attributes_type, input_value=[<app.models.pitch.Pitch ...ject at 0x7734d2fd0250>], input_type=list]\n    For further information visit https://errors.pydantic.dev/2.10/v/model_attributes_type"}}
{"timestamp": "2025-04-22T08:08:21.857742", "level": "ERROR", "message": "Error generating AI melody question: 1 validation error for MelodyNotePitch\npitch\n  Input should be a valid dictionary or object to extract fields from [type=model_attributes_type, input_value=[<app.models.pitch.Pitch ...ject at 0x7734d2fd0250>], input_type=list]\n    For further information visit https://errors.pydantic.dev/2.10/v/model_attributes_type", "module": "ai_melody_service", "function": "generate_melody_question", "line": 92, "exception": {"type": "ValidationError", "message": "1 validation error for MelodyNotePitch\npitch\n  Input should be a valid dictionary or object to extract fields from [type=model_attributes_type, input_value=[<app.models.pitch.Pitch ...ject at 0x7734d2fd0250>], input_type=list]\n    For further information visit https://errors.pydantic.dev/2.10/v/model_attributes_type", "traceback": "Traceback (most recent call last):\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 41, in generate_melody_question\n    correct_melody = await self._generate_ai_melody(request)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 110, in _generate_ai_melody\n    melody = self._parse_ai_response({}, request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 357, in _parse_ai_response\n    melody_note = MelodyNotePitch(\n                  ^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/site-packages/pydantic/main.py\", line 214, in __init__\n    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\npydantic_core._pydantic_core.ValidationError: 1 validation error for MelodyNotePitch\npitch\n  Input should be a valid dictionary or object to extract fields from [type=model_attributes_type, input_value=[<app.models.pitch.Pitch ...ject at 0x7734d2fd0250>], input_type=list]\n    For further information visit https://errors.pydantic.dev/2.10/v/model_attributes_type"}}
{"timestamp": "2025-04-22T08:08:21.861179", "level": "ERROR", "message": "Error in generate_ai_melody_question : 1 validation error for MelodyNotePitch\npitch\n  Input should be a valid dictionary or object to extract fields from [type=model_attributes_type, input_value=[<app.models.pitch.Pitch ...ject at 0x7734d2fd0250>], input_type=list]\n    For further information visit https://errors.pydantic.dev/2.10/v/model_attributes_type\nTraceback: Traceback (most recent call last):\n  File \"/home/yu/gitdev/shengyibaodian/app/api/v1/melody_api.py\", line 49, in generate_ai_melody_question\n    return await ai_melody_service.generate_melody_question(melody_question_request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 41, in generate_melody_question\n    correct_melody = await self._generate_ai_melody(request)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 110, in _generate_ai_melody\n    melody = self._parse_ai_response({}, request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 357, in _parse_ai_response\n    melody_note = MelodyNotePitch(\n                  ^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/site-packages/pydantic/main.py\", line 214, in __init__\n    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\npydantic_core._pydantic_core.ValidationError: 1 validation error for MelodyNotePitch\npitch\n  Input should be a valid dictionary or object to extract fields from [type=model_attributes_type, input_value=[<app.models.pitch.Pitch ...ject at 0x7734d2fd0250>], input_type=list]\n    For further information visit https://errors.pydantic.dev/2.10/v/model_attributes_type\n", "module": "melody_api", "function": "generate_ai_melody_question", "line": 52}
{"timestamp": "2025-04-22T08:09:24.312400", "level": "ERROR", "message": "Error generating AI melody question: 'AIMelodyService' object has no attribute '_is_unique_melody'", "module": "ai_melody_service", "function": "generate_melody_question", "line": 92, "exception": {"type": "AttributeError", "message": "'AIMelodyService' object has no attribute '_is_unique_melody'", "traceback": "Traceback (most recent call last):\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 51, in generate_melody_question\n    if self._is_unique_melody(wrong_melody, unique_wrong_options) and self._is_unique_melody(wrong_melody, [correct_melody]):\n       ^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: 'AIMelodyService' object has no attribute '_is_unique_melody'"}}
{"timestamp": "2025-04-22T08:09:24.314463", "level": "ERROR", "message": "Error in generate_ai_melody_question : 'AIMelodyService' object has no attribute '_is_unique_melody'\nTraceback: Traceback (most recent call last):\n  File \"/home/yu/gitdev/shengyibaodian/app/api/v1/melody_api.py\", line 49, in generate_ai_melody_question\n    return await ai_melody_service.generate_melody_question(melody_question_request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 51, in generate_melody_question\n    if self._is_unique_melody(wrong_melody, unique_wrong_options) and self._is_unique_melody(wrong_melody, [correct_melody]):\n       ^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: 'AIMelodyService' object has no attribute '_is_unique_melody'\n", "module": "melody_api", "function": "generate_ai_melody_question", "line": 52}
{"timestamp": "2025-04-22T08:19:09.854168", "level": "ERROR", "message": "Error parsing AI response: Expecting value: line 1 column 1 (char 0)", "module": "ai_melody_service", "function": "_parse_ai_response", "line": 379, "exception": {"type": "JSONDecodeError", "message": "Expecting value: line 1 column 1 (char 0)", "traceback": "Traceback (most recent call last):\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 216, in _parse_ai_response\n    melody_data = json.loads(response[\"choices\"][0][\"message\"][\"content\"])\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/__init__.py\", line 346, in loads\n    return _default_decoder.decode(s)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/decoder.py\", line 337, in decode\n    obj, end = self.raw_decode(s, idx=_w(s, 0).end())\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/decoder.py\", line 355, in raw_decode\n    raise JSONDecodeError(\"Expecting value\", s, err.value) from None\njson.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)"}}
{"timestamp": "2025-04-22T08:19:09.857739", "level": "ERROR", "message": "Error generating AI melody: Expecting value: line 1 column 1 (char 0)", "module": "ai_melody_service", "function": "_generate_ai_melody", "line": 115, "exception": {"type": "JSONDecodeError", "message": "Expecting value: line 1 column 1 (char 0)", "traceback": "Traceback (most recent call last):\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 109, in _generate_ai_melody\n    melody = self._parse_ai_response(response, request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 216, in _parse_ai_response\n    melody_data = json.loads(response[\"choices\"][0][\"message\"][\"content\"])\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/__init__.py\", line 346, in loads\n    return _default_decoder.decode(s)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/decoder.py\", line 337, in decode\n    obj, end = self.raw_decode(s, idx=_w(s, 0).end())\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/decoder.py\", line 355, in raw_decode\n    raise JSONDecodeError(\"Expecting value\", s, err.value) from None\njson.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)"}}
{"timestamp": "2025-04-22T08:19:09.859947", "level": "ERROR", "message": "Error generating AI melody question: Expecting value: line 1 column 1 (char 0)", "module": "ai_melody_service", "function": "generate_melody_question", "line": 92, "exception": {"type": "JSONDecodeError", "message": "Expecting value: line 1 column 1 (char 0)", "traceback": "Traceback (most recent call last):\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 41, in generate_melody_question\n    correct_melody = await self._generate_ai_melody(request)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 109, in _generate_ai_melody\n    melody = self._parse_ai_response(response, request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 216, in _parse_ai_response\n    melody_data = json.loads(response[\"choices\"][0][\"message\"][\"content\"])\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/__init__.py\", line 346, in loads\n    return _default_decoder.decode(s)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/decoder.py\", line 337, in decode\n    obj, end = self.raw_decode(s, idx=_w(s, 0).end())\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/decoder.py\", line 355, in raw_decode\n    raise JSONDecodeError(\"Expecting value\", s, err.value) from None\njson.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)"}}
{"timestamp": "2025-04-22T08:19:09.860946", "level": "ERROR", "message": "Error in generate_ai_melody_question : Expecting value: line 1 column 1 (char 0)\nTraceback: Traceback (most recent call last):\n  File \"/home/yu/gitdev/shengyibaodian/app/api/v1/melody_api.py\", line 49, in generate_ai_melody_question\n    return await ai_melody_service.generate_melody_question(melody_question_request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 41, in generate_melody_question\n    correct_melody = await self._generate_ai_melody(request)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 109, in _generate_ai_melody\n    melody = self._parse_ai_response(response, request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 216, in _parse_ai_response\n    melody_data = json.loads(response[\"choices\"][0][\"message\"][\"content\"])\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/__init__.py\", line 346, in loads\n    return _default_decoder.decode(s)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/decoder.py\", line 337, in decode\n    obj, end = self.raw_decode(s, idx=_w(s, 0).end())\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/decoder.py\", line 355, in raw_decode\n    raise JSONDecodeError(\"Expecting value\", s, err.value) from None\njson.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)\n", "module": "melody_api", "function": "generate_ai_melody_question", "line": 52}
{"timestamp": "2025-04-22T08:51:39.691808", "level": "ERROR", "message": "Error generating AI melody: type object 'datetime.time' has no attribute 'time'", "module": "ai_melody_service", "function": "_generate_ai_melody", "line": 116, "exception": {"type": "AttributeError", "message": "type object 'datetime.time' has no attribute 'time'", "traceback": "Traceback (most recent call last):\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 106, in _generate_ai_melody\n    response = await self._call_deepseek_api(prompt)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 182, in _call_deepseek_api\n    start_time = time.time()\n                 ^^^^^^^^^\nAttributeError: type object 'datetime.time' has no attribute 'time'"}}
{"timestamp": "2025-04-22T08:51:39.692934", "level": "ERROR", "message": "Error generating AI melody question: type object 'datetime.time' has no attribute 'time'", "module": "ai_melody_service", "function": "generate_melody_question", "line": 93, "exception": {"type": "AttributeError", "message": "type object 'datetime.time' has no attribute 'time'", "traceback": "Traceback (most recent call last):\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 42, in generate_melody_question\n    correct_melody = await self._generate_ai_melody(request)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 106, in _generate_ai_melody\n    response = await self._call_deepseek_api(prompt)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 182, in _call_deepseek_api\n    start_time = time.time()\n                 ^^^^^^^^^\nAttributeError: type object 'datetime.time' has no attribute 'time'"}}
{"timestamp": "2025-04-22T08:51:39.693649", "level": "ERROR", "message": "Error in generate_ai_melody_question : type object 'datetime.time' has no attribute 'time'\nTraceback: Traceback (most recent call last):\n  File \"/home/yu/gitdev/shengyibaodian/app/api/v1/melody_api.py\", line 49, in generate_ai_melody_question\n    return await ai_melody_service.generate_melody_question(melody_question_request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 42, in generate_melody_question\n    correct_melody = await self._generate_ai_melody(request)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 106, in _generate_ai_melody\n    response = await self._call_deepseek_api(prompt)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 182, in _call_deepseek_api\n    start_time = time.time()\n                 ^^^^^^^^^\nAttributeError: type object 'datetime.time' has no attribute 'time'\n", "module": "melody_api", "function": "generate_ai_melody_question", "line": 52}
{"timestamp": "2025-04-22T08:57:27.398378", "level": "ERROR", "message": "Error parsing AI response: Unterminated string starting at: line 90 column 25 (char 2784)", "module": "ai_melody_service", "function": "_parse_ai_response", "line": 383, "exception": {"type": "JSONDecodeError", "message": "Unterminated string starting at: line 90 column 25 (char 2784)", "traceback": "Traceback (most recent call last):\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 220, in _parse_ai_response\n    melody_data = json.loads(cleaned_content)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/__init__.py\", line 346, in loads\n    return _default_decoder.decode(s)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/decoder.py\", line 337, in decode\n    obj, end = self.raw_decode(s, idx=_w(s, 0).end())\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/decoder.py\", line 353, in raw_decode\n    obj, end = self.scan_once(s, idx)\n               ^^^^^^^^^^^^^^^^^^^^^^\njson.decoder.JSONDecodeError: Unterminated string starting at: line 90 column 25 (char 2784)"}}
{"timestamp": "2025-04-22T08:57:27.401775", "level": "ERROR", "message": "Error generating AI melody: Unterminated string starting at: line 90 column 25 (char 2784)", "module": "ai_melody_service", "function": "_generate_ai_melody", "line": 116, "exception": {"type": "JSONDecodeError", "message": "Unterminated string starting at: line 90 column 25 (char 2784)", "traceback": "Traceback (most recent call last):\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 110, in _generate_ai_melody\n    melody = self._parse_ai_response(response, request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 220, in _parse_ai_response\n    melody_data = json.loads(cleaned_content)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/__init__.py\", line 346, in loads\n    return _default_decoder.decode(s)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/decoder.py\", line 337, in decode\n    obj, end = self.raw_decode(s, idx=_w(s, 0).end())\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/decoder.py\", line 353, in raw_decode\n    obj, end = self.scan_once(s, idx)\n               ^^^^^^^^^^^^^^^^^^^^^^\njson.decoder.JSONDecodeError: Unterminated string starting at: line 90 column 25 (char 2784)"}}
{"timestamp": "2025-04-22T08:57:27.404268", "level": "ERROR", "message": "Error generating AI melody question: Unterminated string starting at: line 90 column 25 (char 2784)", "module": "ai_melody_service", "function": "generate_melody_question", "line": 93, "exception": {"type": "JSONDecodeError", "message": "Unterminated string starting at: line 90 column 25 (char 2784)", "traceback": "Traceback (most recent call last):\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 42, in generate_melody_question\n    correct_melody = await self._generate_ai_melody(request)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 110, in _generate_ai_melody\n    melody = self._parse_ai_response(response, request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 220, in _parse_ai_response\n    melody_data = json.loads(cleaned_content)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/__init__.py\", line 346, in loads\n    return _default_decoder.decode(s)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/decoder.py\", line 337, in decode\n    obj, end = self.raw_decode(s, idx=_w(s, 0).end())\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/decoder.py\", line 353, in raw_decode\n    obj, end = self.scan_once(s, idx)\n               ^^^^^^^^^^^^^^^^^^^^^^\njson.decoder.JSONDecodeError: Unterminated string starting at: line 90 column 25 (char 2784)"}}
{"timestamp": "2025-04-22T08:57:27.405317", "level": "ERROR", "message": "Error in generate_ai_melody_question : Unterminated string starting at: line 90 column 25 (char 2784)\nTraceback: Traceback (most recent call last):\n  File \"/home/yu/gitdev/shengyibaodian/app/api/v1/melody_api.py\", line 49, in generate_ai_melody_question\n    return await ai_melody_service.generate_melody_question(melody_question_request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 42, in generate_melody_question\n    correct_melody = await self._generate_ai_melody(request)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 110, in _generate_ai_melody\n    melody = self._parse_ai_response(response, request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 220, in _parse_ai_response\n    melody_data = json.loads(cleaned_content)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/__init__.py\", line 346, in loads\n    return _default_decoder.decode(s)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/decoder.py\", line 337, in decode\n    obj, end = self.raw_decode(s, idx=_w(s, 0).end())\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/decoder.py\", line 353, in raw_decode\n    obj, end = self.scan_once(s, idx)\n               ^^^^^^^^^^^^^^^^^^^^^^\njson.decoder.JSONDecodeError: Unterminated string starting at: line 90 column 25 (char 2784)\n", "module": "melody_api", "function": "generate_ai_melody_question", "line": 52}
{"timestamp": "2025-04-22T08:58:54.235755", "level": "ERROR", "message": "Error parsing AI response: Unterminated string starting at: line 85 column 25 (char 2741)", "module": "ai_melody_service", "function": "_parse_ai_response", "line": 384, "exception": {"type": "JSONDecodeError", "message": "Unterminated string starting at: line 85 column 25 (char 2741)", "traceback": "Traceback (most recent call last):\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 221, in _parse_ai_response\n    melody_data = json.loads(cleaned_content)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/__init__.py\", line 346, in loads\n    return _default_decoder.decode(s)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/decoder.py\", line 337, in decode\n    obj, end = self.raw_decode(s, idx=_w(s, 0).end())\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/decoder.py\", line 353, in raw_decode\n    obj, end = self.scan_once(s, idx)\n               ^^^^^^^^^^^^^^^^^^^^^^\njson.decoder.JSONDecodeError: Unterminated string starting at: line 85 column 25 (char 2741)"}}
{"timestamp": "2025-04-22T08:58:54.238710", "level": "ERROR", "message": "Error generating AI melody: Unterminated string starting at: line 85 column 25 (char 2741)", "module": "ai_melody_service", "function": "_generate_ai_melody", "line": 116, "exception": {"type": "JSONDecodeError", "message": "Unterminated string starting at: line 85 column 25 (char 2741)", "traceback": "Traceback (most recent call last):\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 110, in _generate_ai_melody\n    melody = self._parse_ai_response(response, request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 221, in _parse_ai_response\n    melody_data = json.loads(cleaned_content)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/__init__.py\", line 346, in loads\n    return _default_decoder.decode(s)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/decoder.py\", line 337, in decode\n    obj, end = self.raw_decode(s, idx=_w(s, 0).end())\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/decoder.py\", line 353, in raw_decode\n    obj, end = self.scan_once(s, idx)\n               ^^^^^^^^^^^^^^^^^^^^^^\njson.decoder.JSONDecodeError: Unterminated string starting at: line 85 column 25 (char 2741)"}}
{"timestamp": "2025-04-22T08:58:54.240909", "level": "ERROR", "message": "Error generating AI melody question: Unterminated string starting at: line 85 column 25 (char 2741)", "module": "ai_melody_service", "function": "generate_melody_question", "line": 93, "exception": {"type": "JSONDecodeError", "message": "Unterminated string starting at: line 85 column 25 (char 2741)", "traceback": "Traceback (most recent call last):\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 42, in generate_melody_question\n    correct_melody = await self._generate_ai_melody(request)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 110, in _generate_ai_melody\n    melody = self._parse_ai_response(response, request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 221, in _parse_ai_response\n    melody_data = json.loads(cleaned_content)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/__init__.py\", line 346, in loads\n    return _default_decoder.decode(s)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/decoder.py\", line 337, in decode\n    obj, end = self.raw_decode(s, idx=_w(s, 0).end())\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/decoder.py\", line 353, in raw_decode\n    obj, end = self.scan_once(s, idx)\n               ^^^^^^^^^^^^^^^^^^^^^^\njson.decoder.JSONDecodeError: Unterminated string starting at: line 85 column 25 (char 2741)"}}
{"timestamp": "2025-04-22T08:58:54.241830", "level": "ERROR", "message": "Error in generate_ai_melody_question : Unterminated string starting at: line 85 column 25 (char 2741)\nTraceback: Traceback (most recent call last):\n  File \"/home/yu/gitdev/shengyibaodian/app/api/v1/melody_api.py\", line 49, in generate_ai_melody_question\n    return await ai_melody_service.generate_melody_question(melody_question_request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 42, in generate_melody_question\n    correct_melody = await self._generate_ai_melody(request)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 110, in _generate_ai_melody\n    melody = self._parse_ai_response(response, request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 221, in _parse_ai_response\n    melody_data = json.loads(cleaned_content)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/__init__.py\", line 346, in loads\n    return _default_decoder.decode(s)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/decoder.py\", line 337, in decode\n    obj, end = self.raw_decode(s, idx=_w(s, 0).end())\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/dev/anaconda3/envs/shengyibaodian/lib/python3.11/json/decoder.py\", line 353, in raw_decode\n    obj, end = self.scan_once(s, idx)\n               ^^^^^^^^^^^^^^^^^^^^^^\njson.decoder.JSONDecodeError: Unterminated string starting at: line 85 column 25 (char 2741)\n", "module": "melody_api", "function": "generate_ai_melody_question", "line": 52}
{"timestamp": "2025-04-22T09:08:20.076220", "level": "ERROR", "message": "Error parsing AI response: 'is_rest'", "module": "ai_melody_service", "function": "_parse_ai_response", "line": 384, "exception": {"type": "KeyError", "message": "'is_rest'", "traceback": "Traceback (most recent call last):\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 365, in _parse_ai_response\n    is_rest = False if note_data[\"is_rest\"] is None else True,\n                       ~~~~~~~~~^^^^^^^^^^^\nKeyError: 'is_rest'"}}
{"timestamp": "2025-04-22T09:08:20.080906", "level": "ERROR", "message": "Error generating AI melody: 'is_rest'", "module": "ai_melody_service", "function": "_generate_ai_melody", "line": 116, "exception": {"type": "KeyError", "message": "'is_rest'", "traceback": "Traceback (most recent call last):\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 110, in _generate_ai_melody\n    melody = self._parse_ai_response(response, request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 365, in _parse_ai_response\n    is_rest = False if note_data[\"is_rest\"] is None else True,\n                       ~~~~~~~~~^^^^^^^^^^^\nKeyError: 'is_rest'"}}
{"timestamp": "2025-04-22T09:08:20.082810", "level": "ERROR", "message": "Error generating AI melody question: 'is_rest'", "module": "ai_melody_service", "function": "generate_melody_question", "line": 93, "exception": {"type": "KeyError", "message": "'is_rest'", "traceback": "Traceback (most recent call last):\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 42, in generate_melody_question\n    correct_melody = await self._generate_ai_melody(request)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 110, in _generate_ai_melody\n    melody = self._parse_ai_response(response, request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 365, in _parse_ai_response\n    is_rest = False if note_data[\"is_rest\"] is None else True,\n                       ~~~~~~~~~^^^^^^^^^^^\nKeyError: 'is_rest'"}}
{"timestamp": "2025-04-22T09:08:20.083709", "level": "ERROR", "message": "Error in generate_ai_melody_question : 'is_rest'\nTraceback: Traceback (most recent call last):\n  File \"/home/yu/gitdev/shengyibaodian/app/api/v1/melody_api.py\", line 49, in generate_ai_melody_question\n    return await ai_melody_service.generate_melody_question(melody_question_request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 42, in generate_melody_question\n    correct_melody = await self._generate_ai_melody(request)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 110, in _generate_ai_melody\n    melody = self._parse_ai_response(response, request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/yu/gitdev/shengyibaodian/app/services/ai_melody_service.py\", line 365, in _parse_ai_response\n    is_rest = False if note_data[\"is_rest\"] is None else True,\n                       ~~~~~~~~~^^^^^^^^^^^\nKeyError: 'is_rest'\n", "module": "melody_api", "function": "generate_ai_melody_question", "line": 52}
